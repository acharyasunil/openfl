This works (best envoy) -> pip install tensorflow==2.8.2 tensorflow_datasets==4.4.0 jax==0.3.13 jaxlib==0.3.10 flax==0.4.1 protobuf==3.19.4
pip install tensorflow==2.9.1 tensorflow_datasets==4.6.0 jax==0.3.15 jaxlib==0.3.15+cuda11.cudnn82 -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html

import tensorflow_datasets as tfds
import jax.numpy as jnp

def get_datasets():
    """Load MNIST train and test datasets into memory."""
    ds_builder = tfds.builder('cifar10')
    ds_builder.download_and_prepare()
    train_ds = tfds.as_numpy(ds_builder.as_dataset(split='train', batch_size=-1))
    test_ds = tfds.as_numpy(ds_builder.as_dataset(split='test', batch_size=-1))
    # train_ds['image'] = jnp.float32(train_ds['image']) / 255.
    # test_ds['image'] = jnp.float32(test_ds['image']) / 255.
    return train_ds, test_ds

train_ds, test_ds = get_datasets()

print(train_ds)